<!DOCTYPE html>
<html lang="zh">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>注册</title>

    <script src="../js/jquery-3.5.1.min.js"></script>
    <link rel="stylesheet" href="../plugin/toastr/toastr.min.css">
    <script src="../plugin/toastr/toastr.min.js"></script>

    <script src="../plugin/layer/3.1.1/layer.js"></script>
    <script src="../js/common.js"></script>

</head>

<body >

    <div>
        <input id="userName" placeholder="请输入用户名" >
    </div>
    <div>
        <input type="password" id="password" placeholder="请输入密码" >
    </div>
    <div>
        <input type="password" id="rePassword" placeholder="请输入确认密码" >
    </div>
    <div>
        <input type="text" id="phoneNumber" placeholder="请输入手机号" >
    </div>
    <div>
        <input type="text" id="code" placeholder="请输入验证码" > <button id="sendYzmBtn" onclick="sendYzm()" >发送验证码</button>
    </div>
    <div style="font-size: 12px;">
        <button type="button" onclick="login()" >注册</button> 已有账号去<a href="login.html">登陆</a>
    </div>

    </div>



<script>

    function login(){
        $.ajax({
            url:"../register",
            type:"POST",
            data:{
                userName:$("#userName").val(),
                password:$("#password").val(),
                rePassword:$("#rePassword").val(),
                phoneNumber:$("#phoneNumber").val(),
                code:$("#code").val()
            },
            success : function(res) {
                alert(res.message);
                if(res.code == 200){
                    window.location.replace("login.html");
                }
            },error:function (res) {
                alert(res.message);
            }
        });
    }

    function sendYzm(){
        loading();
        $.ajax({
            url:"../sendRegisterYzm",
            type:"POST",
            data:{
                phoneNumber:$("#phoneNumber").val()
            },
            success : function(res) {

                if (res.code == 200) {
                    message.success();
                    yzmSendIndex = 60;
                    $("#sendYzmBtn").attr("disabled",true);
                    lessYzmSendIndex();
                } else {
                    message.error(res.message);
                }
            },error:function (res) {
                message.success(res.message);
            },complete:function (){
                loadingClose();
            }
        });
    }

    var yzmSendIndex = 60;
    function lessYzmSendIndex(){
        yzmSendIndex--;
        if (yzmSendIndex == 0) {
            $("#sendYzmBtn").html("发送验证码");
            $("#sendYzmBtn").attr("disabled",false);
        } else {
            $("#sendYzmBtn").html(yzmSendIndex);
            setTimeout(function (){
                lessYzmSendIndex();
            },1000);
        }
    }
</script>

</body>

</html>
